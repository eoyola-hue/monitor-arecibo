<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#0a1628" id="meta-theme">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Monitor Arecibo">
<meta name="description" content="Monitor meteorolÃ³gico en tiempo real para Arecibo, Puerto Rico.">
<meta property="og:title" content="Monitor MeteorolÃ³gico â€” Arecibo, PR">
<meta property="og:description" content="Alertas NWS Â· Radar Â· RÃ­os Â· Mareas Â· Inundaciones en tiempo real">
<meta property="og:type" content="website">
<title>ğŸŒ€ Monitor MeteorolÃ³gico â€” Arecibo, PR</title>
<script>
const manifestData={name:"Monitor MeteorolÃ³gico Arecibo",short_name:"Monitor PR",description:"Alertas NWS tiempo real â€“ Arecibo, Puerto Rico",start_url:"./",display:"standalone",background_color:"#0a1628",theme_color:"#0a1628",icons:[{src:"https://raw.githubusercontent.com/twitter/twemoji/master/assets/72x72/1f300.png",sizes:"192x192",type:"image/png"}]};
const _mb=new Blob([JSON.stringify(manifestData)],{type:'application/json'});
document.addEventListener('DOMContentLoaded',()=>{const l=document.createElement('link');l.rel='manifest';l.href=URL.createObjectURL(_mb);document.head.appendChild(l);});
const SW_CODE=`self.addEventListener('push',e=>{const d=e.data?e.data.json():{title:'âš ï¸ Alerta MeteorolÃ³gica',body:'Nueva alerta para Puerto Rico',icon:''};e.waitUntil(self.registration.showNotification(d.title,{body:d.body,icon:d.icon||'',vibrate:[200,100,200],tag:'nws-alert',requireInteraction:true}));});self.addEventListener('notificationclick',e=>{e.notification.close();e.waitUntil(clients.openWindow('/'));});self.addEventListener('install',()=>self.skipWaiting());self.addEventListener('activate',e=>e.waitUntil(clients.claim()));`;
if('serviceWorker'in navigator){const b=new Blob([SW_CODE],{type:'application/javascript'});navigator.serviceWorker.register(URL.createObjectURL(b)).catch(()=>{});}
(function(){const s=localStorage.getItem('theme')||'dark';document.documentElement.setAttribute('data-theme',s);})();
</script>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Barlow+Condensed:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
:root{--navy:#0a1628;--deep:#0d1f3c;--ocean:#0e3a6e;--blue:#1565c0;--cyan:#00b4d8;--teal:#00e5d4;--warn:#ff6b35;--danger:#e63946;--safe:#06d6a0;--gold:#ffd166;--text:#e8f4fd;--muted:#7fa8cc;--card:rgba(13,31,60,.88);--border:rgba(0,180,216,.18);--bg:#0a1628;--input-bg:#0e3a6e;--input-border:rgba(0,180,216,.3);--note-bg:rgba(14,58,110,.5);}
[data-theme="light"]{--navy:#f0f6ff;--deep:#e2edf8;--ocean:#c5daf5;--blue:#1565c0;--cyan:#0077a8;--teal:#007a6e;--warn:#d4561e;--danger:#c0202d;--safe:#047a5a;--gold:#9a7200;--text:#0d1f3c;--muted:#3d6080;--card:rgba(240,246,255,.92);--border:rgba(0,119,168,.2);--bg:#e8f2ff;--input-bg:#fff;--input-border:rgba(0,119,168,.35);--note-bg:rgba(197,218,245,.6);}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'Barlow Condensed',sans-serif;min-height:100vh;overflow-x:hidden;transition:background .35s,color .35s;}
[data-theme="dark"] body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 80% 50% at 20% 30%,rgba(21,101,192,.18) 0%,transparent 60%),radial-gradient(ellipse 60% 40% at 80% 70%,rgba(0,180,216,.12) 0%,transparent 50%),radial-gradient(ellipse 40% 60% at 50% 50%,rgba(0,229,212,.05) 0%,transparent 70%);animation:bgP 8s ease-in-out infinite alternate;pointer-events:none;z-index:0;}
[data-theme="dark"] body::after{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,180,216,.04) 1px,transparent 1px),linear-gradient(90deg,rgba(0,180,216,.04) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0;}
@keyframes bgP{from{opacity:.6}to{opacity:1}}
/* HEADER */
.hdr{position:sticky;top:0;z-index:100;padding:13px 22px 11px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;background:rgba(10,22,40,.92);backdrop-filter:blur(16px);transition:background .35s;}
[data-theme="light"] .hdr{background:rgba(224,236,252,.94);}
.hdr h1{font-size:clamp(1.1rem,3.5vw,1.8rem);font-weight:900;letter-spacing:.06em;text-transform:uppercase;line-height:1;}
.hdr h1 span{color:var(--cyan);}
.hdr-sub{font-family:'Space Mono',monospace;font-size:clamp(.45rem,1.3vw,.6rem);color:var(--muted);letter-spacing:.12em;margin-top:3px;text-transform:uppercase;}
.hdr-right{display:flex;flex-direction:column;align-items:flex-end;gap:3px;}
#clock{font-family:'Space Mono',monospace;font-size:clamp(.85rem,2.3vw,1.4rem);color:var(--cyan);letter-spacing:.05em;font-weight:700;}
#date-display{font-family:'Space Mono',monospace;font-size:clamp(.42rem,1.2vw,.58rem);color:var(--muted);letter-spacing:.1em;text-transform:uppercase;}
.hbtns{display:flex;gap:5px;flex-wrap:wrap;justify-content:flex-end;margin-top:2px;}
.hbtn{background:var(--ocean);color:var(--cyan);border:1px solid var(--border);padding:5px 10px;font-family:'Space Mono',monospace;font-size:.54rem;letter-spacing:.1em;cursor:pointer;transition:all .2s;text-transform:uppercase;white-space:nowrap;}
.hbtn:hover,.hbtn.active{background:var(--blue);border-color:var(--cyan);}
/* TABS */
.tabs{display:flex;background:rgba(10,22,40,.7);border-bottom:1px solid var(--border);position:sticky;top:56px;z-index:90;overflow-x:auto;scrollbar-width:none;transition:background .35s;}
[data-theme="light"] .tabs{background:rgba(224,236,252,.85);}
.tabs::-webkit-scrollbar{display:none;}
.tab{padding:9px 16px;font-family:'Space Mono',monospace;font-size:.58rem;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);cursor:pointer;border-bottom:2px solid transparent;white-space:nowrap;transition:all .2s;background:transparent;border-top:none;border-left:none;border-right:none;}
.tab:hover{color:var(--text);}
.tab.active{color:var(--cyan);border-bottom-color:var(--cyan);}
/* MAIN */
.main{position:relative;z-index:5;padding:18px 22px;max-width:1400px;margin:0 auto;}
.panel{display:none;animation:fi .22s ease;}
.panel.active{display:block;}
@keyframes fi{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:none}}
/* ALERT BANNER */
#alert-banner{margin-bottom:18px;display:none;}
.ai{background:linear-gradient(135deg,rgba(230,57,70,.15),rgba(230,57,70,.05));border:1px solid rgba(230,57,70,.5);border-left:4px solid var(--danger);padding:10px 14px;margin-bottom:6px;animation:aP 2s ease-in-out infinite;}
.ai.warn{background:linear-gradient(135deg,rgba(255,107,53,.15),rgba(255,107,53,.05));border-color:rgba(255,107,53,.5);border-left-color:var(--warn);animation:wP 3s ease-in-out infinite;}
.ai.adv{background:linear-gradient(135deg,rgba(255,209,102,.1),rgba(255,209,102,.03));border-color:rgba(255,209,102,.4);border-left-color:var(--gold);animation:none;}
@keyframes aP{0%,100%{border-left-color:var(--danger)}50%{border-left-color:rgba(230,57,70,.3)}}
@keyframes wP{0%,100%{border-left-color:var(--warn)}50%{border-left-color:rgba(255,107,53,.3)}}
.ai-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;flex-wrap:wrap;gap:3px;}
.ai-type{font-family:'Space Mono',monospace;font-size:.58rem;letter-spacing:.12em;text-transform:uppercase;font-weight:700;}
.ai .ai-type{color:var(--danger);}.ai.warn .ai-type{color:var(--warn);}.ai.adv .ai-type{color:var(--gold);}
.ai-exp{font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted);}
.ai-title{font-size:.85rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;margin-bottom:1px;}
.ai-desc{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.5;}
/* GRIDS */
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:14px;}
.g2{display:grid;grid-template-columns:2fr 1fr;gap:14px;margin-bottom:14px;}
.g2b{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px;}
.g1{margin-bottom:14px;}
/* CARDS */
.card{background:var(--card);border:1px solid var(--border);backdrop-filter:blur(10px);padding:14px 16px;position:relative;overflow:hidden;transition:border-color .3s,background .35s;}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--cyan),transparent);}
.card:hover{border-color:rgba(0,180,216,.4);}
.card.dc::before{background:linear-gradient(90deg,var(--danger),transparent);}
.card.wc::before{background:linear-gradient(90deg,var(--warn),transparent);}
.card.sc::before{background:linear-gradient(90deg,var(--safe),transparent);}
.card.tc::before{background:linear-gradient(90deg,var(--teal),transparent);}
.card.gc::before{background:linear-gradient(90deg,var(--gold),transparent);}
.clbl{font-family:'Space Mono',monospace;font-size:.54rem;letter-spacing:.18em;text-transform:uppercase;color:var(--muted);margin-bottom:9px;display:flex;align-items:center;gap:7px;}
.clbl::after{content:'';flex:1;height:1px;background:var(--border);}
.subinfo{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);margin-top:5px;letter-spacing:.05em;}
.si{display:inline-flex;align-items:center;gap:5px;font-size:.7rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;margin-top:6px;}
.dot{width:8px;height:8px;border-radius:50%;animation:blink 1.5s ease-in-out infinite;flex-shrink:0;}
.dot.safe{background:var(--safe);box-shadow:0 0 8px var(--safe);}
.dot.warn{background:var(--warn);box-shadow:0 0 8px var(--warn);}
.dot.danger{background:var(--danger);box-shadow:0 0 8px var(--danger);}
.dot.info{background:var(--cyan);box-shadow:0 0 8px var(--cyan);}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.35}}
/* GAUGE */
.gb{width:100%;height:12px;background:rgba(14,58,110,.5);border:1px solid var(--border);position:relative;overflow:hidden;margin-bottom:10px;}
.gf{height:100%;transition:width 1.5s cubic-bezier(.4,0,.2,1);position:relative;}
.gf::after{content:'';position:absolute;right:0;top:0;bottom:0;width:2px;background:#fff;box-shadow:0 0 8px #fff;}
.glbls{display:flex;justify-content:space-between;font-family:'Space Mono',monospace;font-size:.48rem;color:var(--muted);text-transform:uppercase;margin-bottom:7px;}
.rv{font-size:1.9rem;font-weight:900;text-align:center;}
.rl{font-size:.76rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;text-align:center;margin-top:2px;}
/* FORECAST */
.fcg{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;}
.fcd{background:rgba(14,58,110,.4);border:1px solid var(--border);padding:9px 4px;text-align:center;transition:all .2s;}
[data-theme="light"] .fcd{background:rgba(197,218,245,.5);}
.fcd:hover{background:rgba(21,101,192,.4);border-color:rgba(0,180,216,.4);}
.fcd .dn{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;margin-bottom:4px;}
.fcd .di{font-size:1.3rem;display:block;margin-bottom:3px;}
.fcd .dt{font-size:1.05rem;font-weight:700;}
.fcd .dr{font-family:'Space Mono',monospace;font-size:.54rem;margin-top:2px;}
.fcd .ds{font-size:.56rem;color:var(--muted);margin-top:2px;line-height:1.3;}
/* MARITIME */
.mt{width:100%;border-collapse:collapse;font-family:'Space Mono',monospace;font-size:.62rem;}
.mt td{padding:7px 0;border-bottom:1px solid var(--border);vertical-align:middle;}
.mt td:first-child{color:var(--muted);width:42%;text-transform:uppercase;letter-spacing:.06em;}
.mt td:last-child{color:var(--text);font-weight:700;font-size:.74rem;text-align:right;}
.ml{padding:2px 6px;font-size:.54rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;}
.ml.danger{background:rgba(230,57,70,.2);color:var(--danger);border:1px solid var(--danger);}
.ml.warn{background:rgba(255,107,53,.2);color:var(--warn);border:1px solid var(--warn);}
.ml.safe{background:rgba(6,214,160,.2);color:var(--safe);border:1px solid var(--safe);}
.ml.info{background:rgba(0,180,216,.2);color:var(--cyan);border:1px solid var(--cyan);}
/* RIVERS */
.rt{width:100%;border-collapse:collapse;}
.rt th{font-family:'Space Mono',monospace;font-size:.54rem;color:var(--cyan);text-transform:uppercase;letter-spacing:.1em;padding:6px 8px;border-bottom:1px solid var(--border);text-align:left;}
.rt td{font-family:'Space Mono',monospace;font-size:.62rem;padding:7px 8px;border-bottom:1px solid rgba(0,180,216,.08);vertical-align:middle;}
.rt tr:hover td{background:rgba(14,58,110,.3);}
.rt a{color:var(--cyan);text-decoration:none;}.rt a:hover{color:var(--teal);text-decoration:underline;}
.rs{padding:2px 6px;font-size:.52rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;}
/* RESOURCES */
.rg{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:4px;}
.rc{display:block;background:rgba(14,58,110,.4);border:1px solid var(--border);padding:11px 9px;text-decoration:none;color:var(--text);transition:all .2s;}
[data-theme="light"] .rc{background:rgba(197,218,245,.5);}
.rc:hover{background:rgba(21,101,192,.4);border-color:rgba(0,180,216,.4);}
.rc .ri{font-size:1.3rem;margin-bottom:4px;display:block;}
.rc .rn{font-weight:700;font-size:.78rem;letter-spacing:.04em;display:block;margin-bottom:2px;}
.rc .ru{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);display:block;}
/* TIDES */
.tide-tl{display:flex;gap:2px;height:56px;align-items:flex-end;margin-bottom:5px;}
.tide-b{flex:1;border-radius:2px 2px 0 0;transition:height .5s cubic-bezier(.4,0,.2,1);min-height:3px;background:linear-gradient(to top,var(--cyan),var(--teal));opacity:.65;}
.tide-b.high{background:linear-gradient(to top,var(--warn),var(--gold));}
.tide-b.now{opacity:1;box-shadow:0 0 6px var(--cyan);}
.tide-lbls{display:flex;justify-content:space-between;font-family:'Space Mono',monospace;font-size:.48rem;color:var(--muted);}
.tide-row{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;}
.tide-it{flex:1;min-width:72px;background:rgba(14,58,110,.4);border:1px solid var(--border);padding:7px;text-align:center;}
[data-theme="light"] .tide-it{background:rgba(197,218,245,.5);}
.tide-it .tl{font-family:'Space Mono',monospace;font-size:.5rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;}
.tide-it .tv{font-size:1rem;font-weight:700;margin-top:1px;}
.tide-it .tt{font-family:'Space Mono',monospace;font-size:.54rem;color:var(--cyan);margin-top:1px;}
/* HISTORY */
.hi{border:1px solid var(--border);padding:9px 12px;margin-bottom:6px;background:rgba(14,58,110,.2);position:relative;transition:background .2s;}
[data-theme="light"] .hi{background:rgba(197,218,245,.4);}
.hi:hover{background:rgba(14,58,110,.4);}
.hib{display:inline-block;padding:1px 6px;font-family:'Space Mono',monospace;font-size:.5rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;margin-bottom:4px;}
.hit{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);position:absolute;top:9px;right:11px;}
.hiT{font-size:.8rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;margin-bottom:1px;}
.hiA{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);}
/* NOTES */
.nf{display:flex;flex-direction:column;gap:9px;margin-bottom:14px;}
.nf input,.nf select,.nf textarea{background:var(--input-bg);border:1px solid var(--input-border);color:var(--text);font-family:'Barlow Condensed',sans-serif;font-size:.92rem;padding:8px 11px;width:100%;transition:border-color .2s;outline:none;}
.nf input:focus,.nf select:focus,.nf textarea:focus{border-color:var(--cyan);}
.nf select option{background:var(--deep);color:var(--text);}
.nf textarea{resize:vertical;min-height:72px;}
.nr{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
.nlbl{font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted);text-transform:uppercase;letter-spacing:.12em;margin-bottom:2px;}
.btn-p{background:var(--cyan);color:var(--navy);border:none;padding:9px 18px;font-family:'Space Mono',monospace;font-size:.62rem;letter-spacing:.12em;text-transform:uppercase;cursor:pointer;font-weight:700;transition:all .2s;align-self:flex-start;}
.btn-p:hover{background:var(--teal);}
.btn-ds{background:transparent;color:var(--danger);border:1px solid var(--danger);padding:3px 7px;font-family:'Space Mono',monospace;font-size:.5rem;cursor:pointer;letter-spacing:.08em;transition:all .2s;}
.btn-ds:hover{background:rgba(230,57,70,.15);}
.nc{background:var(--note-bg);border:1px solid rgba(0,180,216,.25);border-left:3px solid var(--cyan);padding:11px 13px;margin-bottom:7px;position:relative;transition:background .2s;}
.nc.severo{border-left-color:var(--danger);}.nc.moderado{border-left-color:var(--warn);}.nc.menor{border-left-color:var(--gold);}.nc.info{border-left-color:var(--cyan);}
.nc-hdr{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px;gap:7px;}
.nc-meta{display:flex;gap:5px;align-items:center;flex-wrap:wrap;}
.nt{font-family:'Space Mono',monospace;font-size:.52rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;padding:2px 6px;border:1px solid;}
.nt.severo{color:var(--danger);border-color:var(--danger);background:rgba(230,57,70,.1);}
.nt.moderado{color:var(--warn);border-color:var(--warn);background:rgba(255,107,53,.1);}
.nt.menor{color:var(--gold);border-color:var(--gold);background:rgba(255,209,102,.1);}
.nt.info{color:var(--cyan);border-color:var(--cyan);background:rgba(0,180,216,.1);}
.nc-time{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);}
.nc-title{font-size:.88rem;font-weight:700;margin-bottom:3px;}
.nc-body{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);line-height:1.6;}
.nc-loc{font-family:'Space Mono',monospace;font-size:.54rem;color:var(--cyan);margin-top:3px;}
.nca{position:absolute;top:9px;right:9px;}
.ne{font-family:'Space Mono',monospace;font-size:.66rem;color:var(--muted);text-align:center;padding:26px;border:1px dashed var(--border);}
.nstats{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;}
.nst{flex:1;min-width:64px;background:rgba(14,58,110,.4);border:1px solid var(--border);padding:7px;text-align:center;}
[data-theme="light"] .nst{background:rgba(197,218,245,.5);}
.nst .nsv{font-size:1.3rem;font-weight:900;}
.nst .nsl{font-family:'Space Mono',monospace;font-size:.5rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;}
/* RADAR */
.radar-wrap{position:relative;width:100%;background:#000;border:1px solid var(--border);overflow:hidden;}
.radar-wrap iframe{width:100%;height:460px;border:none;display:block;}
.radar-ovl{position:absolute;top:8px;left:8px;background:rgba(10,22,40,.85);padding:4px 9px;font-family:'Space Mono',monospace;font-size:.54rem;color:var(--cyan);letter-spacing:.1em;text-transform:uppercase;pointer-events:none;}
.rlinks{display:flex;gap:7px;margin-top:7px;flex-wrap:wrap;}
.rlink{display:inline-block;background:rgba(14,58,110,.5);border:1px solid var(--border);padding:5px 10px;text-decoration:none;color:var(--cyan);font-family:'Space Mono',monospace;font-size:.56rem;letter-spacing:.08em;transition:all .2s;}
.rlink:hover{background:var(--ocean);border-color:var(--cyan);}
/* NOTIF */
.ns-box{display:flex;align-items:center;gap:9px;padding:11px;background:rgba(14,58,110,.4);border:1px solid var(--border);margin-bottom:10px;}
.ns-icon{font-size:1.4rem;}
.ns-txt{flex:1;}
.ns-txt strong{font-size:.86rem;display:block;margin-bottom:2px;}
.ns-txt span{font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);}
.btn-n{font-family:'Space Mono',monospace;font-size:.56rem;letter-spacing:.1em;text-transform:uppercase;padding:6px 12px;cursor:pointer;border:1px solid;transition:all .2s;}
.btn-n.enable{background:var(--safe);color:var(--navy);border-color:var(--safe);font-weight:700;}
.btn-n.enable:hover{background:var(--teal);}
.btn-n.disable{background:transparent;color:var(--danger);border-color:var(--danger);}
.btn-n.disable:hover{background:rgba(230,57,70,.1);}
.btn-n.test{background:transparent;color:var(--cyan);border-color:var(--cyan);}
.btn-n.test:hover{background:rgba(0,180,216,.1);}
/* MISC */
.ribbon{position:absolute;top:10px;right:-25px;background:var(--danger);color:#fff;font-family:'Space Mono',monospace;font-size:.49rem;letter-spacing:.1em;text-transform:uppercase;padding:3px 32px;transform:rotate(45deg);font-weight:700;display:none;}
.btmbar{background:rgba(13,31,60,.7);border-top:1px solid var(--border);padding:9px 22px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:7px;position:relative;z-index:5;transition:background .35s;}
[data-theme="light"] .btmbar{background:rgba(224,236,252,.8);}
.srcs{display:flex;gap:12px;flex-wrap:wrap;align-items:center;}
.srcs .l{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);letter-spacing:.15em;text-transform:uppercase;}
.srcs a{color:var(--cyan);text-decoration:none;font-family:'Space Mono',monospace;font-size:.56rem;transition:color .2s;}
.srcs a:hover{color:var(--teal);}
#lu{font-family:'Space Mono',monospace;font-size:.52rem;color:var(--muted);letter-spacing:.06em;}
#ib{display:none;position:fixed;bottom:12px;left:50%;transform:translateX(-50%);background:var(--ocean);border:1px solid var(--cyan);color:var(--text);padding:11px 16px;z-index:200;max-width:320px;width:90%;text-align:center;box-shadow:0 8px 32px rgba(0,0,0,.5);}
#ib p{font-size:.74rem;margin-bottom:8px;line-height:1.5;}
#ib .br{display:flex;gap:8px;justify-content:center;}
#ib button{font-family:'Space Mono',monospace;font-size:.56rem;letter-spacing:.1em;text-transform:uppercase;padding:6px 12px;cursor:pointer;border:1px solid var(--cyan);}
#ib #bti{background:var(--cyan);color:var(--navy);}
#ib #btd{background:transparent;color:var(--muted);border-color:var(--border);}
.spin{display:inline-block;width:10px;height:10px;border:2px solid var(--border);border-top-color:var(--cyan);border-radius:50%;animation:sp .8s linear infinite;margin-left:4px;vertical-align:middle;}
@keyframes sp{to{transform:rotate(360deg)}}
.lt{font-family:'Space Mono',monospace;font-size:.64rem;color:var(--muted);letter-spacing:.08em;}
/* RESPONSIVE */
@media(max-width:900px){.g3{grid-template-columns:1fr 1fr;}.g2,.g2b{grid-template-columns:1fr;}.fcg{grid-template-columns:repeat(4,1fr);}.rg{grid-template-columns:1fr 1fr;}.main{padding:12px;}}
@media(max-width:600px){.g3{grid-template-columns:1fr;}.fcg{grid-template-columns:repeat(3,1fr);}.nr{grid-template-columns:1fr;}.hdr{padding:9px 13px;}.main{padding:9px;}.tabs .tab{padding:8px 11px;font-size:.55rem;}.radar-wrap iframe{height:300px;}}
</style>
</head>
<body>

<!-- HEADER -->
<header class="hdr">
  <div>
    <h1>ğŸŒ€ MONITOR <span>METEORO</span>LÃ“GICO</h1>
    <div class="hdr-sub">ğŸ“ Arecibo, Puerto Rico Â· 18.4736Â°N 66.7220Â°W Â· NWS San Juan</div>
  </div>
  <div class="hdr-right">
    <div id="clock">--:--:--</div>
    <div id="date-display">Cargando...</div>
    <div class="hbtns">
      <button class="hbtn" onclick="toggleTheme()" id="theme-btn">ğŸŒ™ Oscuro</button>
      <a class="hbtn" id="pdf-btn" href="reports/reporte_mas_reciente.pdf" target="_blank"
         style="text-decoration:none;display:none">ğŸ“„ Reporte PDF</a>
      <button class="hbtn" onclick="loadAllData()" id="refresh-btn">âŸ³ Actualizar</button>
      <button class="hbtn" onclick="installApp()" id="install-btn" style="display:none">ğŸ“² Instalar</button>
    </div>
  </div>
</header>

<!-- TABS -->
<nav class="tabs">
  <button class="tab active"  onclick="switchTab('inicio',this)">ğŸ  Inicio</button>
  <button class="tab"         onclick="switchTab('radar',this)">ğŸ“¡ Radar</button>
  <button class="tab"         onclick="switchTab('alertas',this)">ğŸš¨ Alertas</button>
  <button class="tab"         onclick="switchTab('pronostico',this)">ğŸ“… PronÃ³stico</button>
  <button class="tab"         onclick="switchTab('maritimo',this)">â›µ MarÃ­timo</button>
  <button class="tab"         onclick="switchTab('mareas',this)">ğŸŒŠ Mareas</button>
  <button class="tab"         onclick="switchTab('rios',this)">ğŸï¸ RÃ­os</button>
  <button class="tab"         onclick="switchTab('notas',this)">ğŸ“ Notas</button>
  <button class="tab"         onclick="switchTab('recursos',this)">ğŸ”— Recursos</button>
</nav>

<main class="main">
<div id="alert-banner"></div>

<!-- â•â•â• INICIO â•â•â• -->
<div id="panel-inicio" class="panel active">
  <div class="g3">
    <div class="card tc">
      <div class="clbl">ğŸŒŠ Riesgo InundaciÃ³n Repentina</div>
      <div class="gb"><div class="gf" id="gauge-fill" style="width:0%"></div></div>
      <div class="glbls"><span>BAJO</span><span>MOD.</span><span>ALTO</span><span>EXTR.</span></div>
      <div class="rv" id="risk-value">â€”</div>
      <div class="rl" id="risk-label">Evaluando...</div>
    </div>
    <div class="card">
      <div class="clbl">ğŸŒ§ï¸ PrecipitaciÃ³n</div>
      <div id="rain-info"><div class="lt">Cargando...<span class="spin"></span></div></div>
    </div>
    <div class="card">
      <div class="clbl">âš¡ Estado del Sistema</div>
      <div id="status-summary"><div class="lt">Evaluando...<span class="spin"></span></div></div>
    </div>
  </div>
  <div class="card g1">
    <div class="clbl">ğŸ“… PrÃ³ximos 7 DÃ­as</div>
    <div class="fcg" id="fcg-home"><div class="lt" style="grid-column:1/-1">Cargando...<span class="spin"></span></div></div>
  </div>
  <div class="g2b">
    <div class="card wc">
      <div class="ribbon" id="mr1">PELIGRO</div>
      <div class="clbl">ğŸŒŠ Condiciones MarÃ­timas</div>
      <table class="mt" id="mt-home"><tr><td>Cargando...</td><td></td></tr></table>
    </div>
    <div class="card gc">
      <div class="clbl">ğŸŒŠ Mareas Hoy â€” Arecibo</div>
      <div id="tides-home"><div class="lt">Calculando...<span class="spin"></span></div></div>
    </div>
  </div>

  <!-- CARD REPORTE PDF -->
  <div class="card g1 sc" id="card-reporte" style="display:none">
    <div class="clbl">ğŸ“„ Ãšltimo Reporte PDF Generado</div>
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px">
      <div id="reporte-info" style="font-family:'Space Mono',monospace;font-size:.62rem;color:var(--muted);line-height:1.9"></div>
      <a id="reporte-download" href="reports/reporte_mas_reciente.pdf" target="_blank"
         style="display:inline-block;background:var(--safe);color:var(--navy);padding:10px 20px;text-decoration:none;font-family:'Space Mono',monospace;font-size:.62rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;transition:all .2s;white-space:nowrap">
        ğŸ“¥ DESCARGAR PDF
      </a>
    </div>
  </div>
</div>

<!-- â•â•â• RADAR â•â•â• -->
<div id="panel-radar" class="panel">
  <div class="card g1">
    <div class="clbl">ğŸ“¡ Radar NWS TJUA â€” Loop Ãšltimas 2 Horas</div>
    <div class="radar-wrap">
      <div class="radar-ovl">ğŸ“¡ NWS RADAR TJUA Â· ARECIBO, PR</div>
      <iframe src="https://radar.weather.gov/station/TJUA/standard" title="Radar NWS San Juan" loading="lazy" sandbox="allow-scripts allow-same-origin allow-popups" referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <div class="rlinks">
      <a href="https://radar.weather.gov/station/TJUA/standard" target="_blank" class="rlink">ğŸ”— Radar Completo</a>
      <a href="https://radar.weather.gov/station/TJUA/loop" target="_blank" class="rlink">â–¶ Loop Animado</a>
      <a href="https://www.tropicaltidbits.com/analysis/radar/?region=pr" target="_blank" class="rlink">ğŸŒ TropicalTidbits</a>
      <a href="https://www.weather.gov/sju/" target="_blank" class="rlink">ğŸŒ€ NWS San Juan</a>
    </div>
  </div>
  <div class="g2b">
    <div class="card">
      <div class="clbl">ğŸ›°ï¸ SatÃ©lite GOES-16 â€” Puerto Rico (Imagen en Vivo)</div>
      <div style="position:relative;background:#000;border:1px solid var(--border);overflow:hidden;">
        <div style="position:absolute;top:7px;left:7px;background:rgba(10,22,40,.85);padding:3px 8px;font-family:'Space Mono',monospace;font-size:.52rem;color:var(--cyan);letter-spacing:.1em;text-transform:uppercase;z-index:2;pointer-events:none;">ğŸ›°ï¸ GOES-16 GEOCOLOR Â· PR</div>
        <img id="goes-img"
          src="https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/pr/GEOCOLOR/latest.jpg"
          alt="SatÃ©lite GOES-16 Puerto Rico"
          style="width:100%;display:block;min-height:200px;object-fit:cover;"
          onerror="this.onerror=null;this.src='https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/pr/02/latest.jpg';document.getElementById('goes-fallback').style.display='block';"
        />
        <div id="goes-fallback" style="display:none;padding:14px;font-family:'Space Mono',monospace;font-size:.62rem;color:var(--muted);text-align:center">
          Imagen no disponible. Ver en: <a href="https://www.star.nesdis.noaa.gov/GOES/sector.php?sat=G16&sector=pr" target="_blank" style="color:var(--cyan)">NOAA GOES Viewer â†’</a>
        </div>
      </div>
      <div class="rlinks" style="margin-top:7px">
        <a href="https://www.star.nesdis.noaa.gov/GOES/sector.php?sat=G16&sector=pr" target="_blank" class="rlink">ğŸ›°ï¸ GOES-16 PR Animado</a>
        <a href="https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/pr/GEOCOLOR/latest.jpg" target="_blank" class="rlink">ğŸ–¼ï¸ Imagen Completa</a>
        <button class="rlink" onclick="refreshGOES()" style="cursor:pointer;border:none">ğŸ”„ Actualizar</button>
      </div>
    </div>
    <div class="card">
      <div class="clbl">ğŸ’¡ CÃ³mo Leer el Radar</div>
      <div style="font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);line-height:2">
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸŸ¢ <span style="color:var(--safe)">VERDE</span> â€” Lluvia leve (0â€“20 dBZ)</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸŸ¡ <span style="color:var(--gold)">AMARILLO</span> â€” Lluvia moderada (20â€“40 dBZ)</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸŸ  <span style="color:var(--warn)">NARANJA</span> â€” Lluvia intensa (40â€“55 dBZ)</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸ”´ <span style="color:var(--danger)">ROJO</span> â€” Lluvia muy intensa (55+ dBZ)</div>
        <div style="padding:5px 0">âš« <span style="color:var(--text)">MAGENTA</span> â€” Granizo posible (65+ dBZ)</div>
        <div style="margin-top:8px;padding:7px;background:rgba(0,180,216,.07);border-left:2px solid var(--cyan);font-size:.58rem">âš ï¸ Vigilar celdas rojo/naranja que se mueven hacia cuencas de rÃ­os. Son las que generan Flash Floods.</div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â• ALERTAS â•â•â• -->
<div id="panel-alertas" class="panel">
  <div class="g2b">
    <div class="card">
      <div class="clbl">ğŸš¨ Alertas Activas â€” Puerto Rico</div>
      <div id="alerts-full"><div class="lt">Buscando...<span class="spin"></span></div></div>
    </div>
    <div class="card gc">
      <div class="clbl">ğŸ“‹ Historial de Alertas (SesiÃ³n)</div>
      <div style="margin-bottom:8px;display:flex;justify-content:space-between;align-items:center">
        <span style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted)">ÃšLTIMAS 50 ALERTAS REGISTRADAS</span>
        <button class="btn-ds" onclick="clearHistory()">ğŸ—‘ Limpiar</button>
      </div>
      <div id="alert-history"><div class="ne">Sin historial aÃºn.</div></div>
    </div>
  </div>
  <div class="card">
    <div class="clbl">ğŸ”” Notificaciones Push</div>
    <div class="ns-box" id="ns-box">
      <div class="ns-icon">ğŸ”•</div>
      <div class="ns-txt"><strong id="ns-title">Notificaciones no activadas</strong><span id="ns-desc">Activa para recibir alertas aunque el dashboard estÃ© cerrado</span></div>
      <button class="btn-n enable" id="ns-btn" onclick="toggleNotif()">Activar</button>
    </div>
    <div style="display:flex;gap:7px;flex-wrap:wrap">
      <button class="btn-n test" onclick="testNotif()">ğŸ”” Enviar Prueba</button>
    </div>
    <div style="margin-top:10px;font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.8;padding:9px;background:rgba(0,180,216,.05);border:1px solid var(--border)">
      âš ï¸ <strong style="color:var(--gold)">CÃ³mo funciona:</strong> Se verifica la API del NWS cada 10 minutos. Si hay nueva alerta Flash Flood o Severe, recibirÃ¡s notificaciÃ³n inmediata. El navegador debe estar abierto en segundo plano (o instalar como app PWA).
    </div>
  </div>
</div>

<!-- â•â•â• PRONÃ“STICO â•â•â• -->
<div id="panel-pronostico" class="panel">
  <div class="card g1">
    <div class="clbl">ğŸ“… PronÃ³stico Detallado 7 DÃ­as â€” Arecibo</div>
    <div class="fcg" id="fcg-full"><div class="lt" style="grid-column:1/-1">Cargando...<span class="spin"></span></div></div>
  </div>
  <div class="g2b">
    <div class="card"><div class="clbl">ğŸŒ™ PronÃ³stico Nocturno</div><div id="night-fc"><div class="lt">Cargando...<span class="spin"></span></div></div></div>
    <div class="card"><div class="clbl">ğŸ“‹ Detalle PrÃ³ximos DÃ­as</div><div id="fc-detail"><div class="lt">Cargando...<span class="spin"></span></div></div></div>
  </div>
</div>

<!-- â•â•â• MARÃTIMO â•â•â• -->
<div id="panel-maritimo" class="panel">
  <div class="g2b">
    <div class="card wc">
      <div class="ribbon" id="mr2">PELIGRO</div>
      <div class="clbl">â›µ Costa Norte PR â€” Aviso Actual</div>
      <table class="mt" id="mt-full"></table>
      <div style="margin-top:10px;padding-top:9px;border-top:1px solid var(--border)">
        <div class="subinfo">âš ï¸ Small Craft Advisory â€” Zona AMZ712 Â· NWS San Juan</div>
      </div>
    </div>
    <div class="card">
      <div class="clbl">ğŸŒŠ Boyas Cercanas â€” NDBC</div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <div style="background:rgba(14,58,110,.4);border:1px solid var(--border);padding:10px">
          <div style="font-weight:700;font-size:.78rem;color:var(--cyan);margin-bottom:4px">ğŸ”´ Boya 41053 â€” San Juan</div>
          <div style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.8">Oleaje: <strong style="color:var(--text)">~2.8 m</strong> Â· Viento: <strong style="color:var(--text)">E 18 kt</strong><br>Temp. Agua: <strong style="color:var(--text)">~27Â°C</strong><br><a href="https://www.ndbc.noaa.gov/station_page.php?station=41053" target="_blank" style="color:var(--cyan)">â†’ Datos en vivo NDBC</a></div>
        </div>
        <div style="background:rgba(14,58,110,.4);border:1px solid var(--border);padding:10px">
          <div style="font-weight:700;font-size:.78rem;color:var(--gold);margin-bottom:4px">ğŸŸ¡ BEPB4 â€” Isla de PÃ¡jaros</div>
          <div style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.8">MÃ¡s cercana a Arecibo Â· Costa norte PR<br><a href="https://www.ndbc.noaa.gov/station_page.php?station=bepb4" target="_blank" style="color:var(--cyan)">â†’ Datos en vivo NDBC</a></div>
        </div>
        <div style="background:rgba(14,58,110,.4);border:1px solid var(--border);padding:10px">
          <div style="font-weight:700;font-size:.78rem;color:var(--gold);margin-bottom:4px">ğŸŸ¡ Boya 41047 â€” AtlÃ¡ntico N</div>
          <div style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.8">Oleaje: <strong style="color:var(--text)">~2.5 m</strong> Â· PerÃ­odo: <strong style="color:var(--text)">~9 seg.</strong><br><a href="https://www.ndbc.noaa.gov/station_page.php?station=41047" target="_blank" style="color:var(--cyan)">â†’ Datos en vivo NDBC</a></div>
        </div>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="clbl">ğŸ”— Recursos MarÃ­timos</div>
    <div class="rg">
      <a href="https://www.ndbc.noaa.gov/obs.shtml?lat=18.5&lon=-66.7&zoom=8&type=buoy" target="_blank" class="rc"><span class="ri">ğŸŒŠ</span><span class="rn">NDBC Boyas PR</span><span class="ru">ndbc.noaa.gov</span></a>
      <a href="https://www.weather.gov/sju/mz" target="_blank" class="rc"><span class="ri">â›µ</span><span class="rn">PronÃ³stico MarÃ­timo</span><span class="ru">weather.gov/sju/mz</span></a>
      <a href="https://tidesandcurrents.noaa.gov/stationhome.html?id=9752695" target="_blank" class="rc"><span class="ri">ğŸŒŠ</span><span class="rn">Mareas Arecibo</span><span class="ru">NOAA ID: 9752695</span></a>
      <a href="https://www.nhc.noaa.gov/" target="_blank" class="rc"><span class="ri">ğŸŒ€</span><span class="rn">NHC Ciclones</span><span class="ru">nhc.noaa.gov</span></a>
      <a href="https://coastwatch.pfeg.noaa.gov/" target="_blank" class="rc"><span class="ri">ğŸ›°ï¸</span><span class="rn">CoastWatch NOAA</span><span class="ru">ImÃ¡genes satÃ©lite</span></a>
      <a href="https://www.weather.gov/sju/" target="_blank" class="rc"><span class="ri">ğŸŒ€</span><span class="rn">NWS San Juan</span><span class="ru">weather.gov/sju</span></a>
    </div>
  </div>
</div>

<!-- â•â•â• MAREAS â•â•â• -->
<div id="panel-mareas" class="panel">
  <div class="g2b">
    <div class="card gc">
      <div class="clbl">ğŸŒŠ Mareas Hoy â€” EstaciÃ³n Arecibo (NOAA #9752695)</div>
      <div id="tides-full"><div class="lt">Calculando...<span class="spin"></span></div></div>
    </div>
    <div class="card">
      <div class="clbl">â„¹ï¸ Sobre las Mareas en Arecibo</div>
      <div style="font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted);line-height:1.9">
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸ“ <strong style="color:var(--text)">EstaciÃ³n:</strong> Arecibo, PR â€” ID 9752695</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸŒŠ <strong style="color:var(--text)">Tipo:</strong> Marea mixta semidiurna</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">ğŸ“ <strong style="color:var(--text)">Rango tÃ­pico:</strong> 0.3 â€“ 0.6 metros</div>
        <div style="padding:5px 0;border-bottom:1px solid var(--border)">âš ï¸ <strong style="color:var(--warn)">Marea de tormenta:</strong> +1-2m adicionales en huracanes</div>
        <div style="padding:5px 0">ğŸ”— <a href="https://tidesandcurrents.noaa.gov/noaatidepredictions.html?id=9752695" target="_blank" style="color:var(--cyan)">â†’ Predicciones oficiales NOAA</a></div>
        <div style="margin-top:8px;padding:7px;background:rgba(255,209,102,.08);border-left:2px solid var(--gold);font-size:.58rem">Mareas altas + oleaje fuerte aumentan riesgo de inundaciÃ³n costera en la zona norte de Arecibo.</div>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="clbl">ğŸ“… Predicciones Oficiales NOAA â€” PrÃ³ximos DÃ­as</div>
    <div style="text-align:center;padding:18px">
      <p style="font-family:'Space Mono',monospace;font-size:.63rem;color:var(--muted);line-height:1.8;margin-bottom:12px">Para predicciones precisas de los prÃ³ximos dÃ­as, consulta la fuente oficial de NOAA Tides &amp; Currents:</p>
      <a href="https://tidesandcurrents.noaa.gov/noaatidepredictions.html?id=9752695&units=standard&timezone=LST/LDT&clock=12hour&datum=MLLW&interval=hilo&action=dailychart" target="_blank" style="display:inline-block;background:var(--gold);color:var(--navy);padding:11px 22px;text-decoration:none;font-family:'Space Mono',monospace;font-size:.62rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;transition:all .2s">
        ğŸŒŠ NOAA TIDES â€” ESTACIÃ“N ARECIBO â†’
      </a>
    </div>
  </div>
</div>

<!-- â•â•â• RÃOS â•â•â• -->
<div id="panel-rios" class="panel">
  <div class="card g1">
    <div class="clbl">ğŸï¸ Estaciones HidrolÃ³gicas â€” Norte PR</div>
    <table class="rt">
      <thead><tr><th>RÃO</th><th>CÃ“DIGO</th><th>ESTADO</th><th>NWS AHPS</th><th>USGS</th></tr></thead>
      <tbody>
        <tr><td style="color:var(--text);font-weight:700">RÃ­o Arecibo</td><td>AREP4</td><td><span class="rs" style="background:rgba(0,180,216,.15);color:var(--cyan);border:1px solid var(--cyan)">ACTIVO</span></td><td><a href="https://water.weather.gov/ahps2/hydrograph.php?gage=AREP4&wfo=sju" target="_blank">â†’ Hidrograma</a></td><td><a href="https://waterdata.usgs.gov/monitoring-location/50029000/" target="_blank">â†’ #50029000</a></td></tr>
        <tr><td style="color:var(--text);font-weight:700">RÃ­o Grande Arecibo</td><td>GRAP4</td><td><span class="rs" style="background:rgba(0,180,216,.15);color:var(--cyan);border:1px solid var(--cyan)">ACTIVO</span></td><td><a href="https://water.weather.gov/ahps2/hydrograph.php?gage=grap4&wfo=sju" target="_blank">â†’ Hidrograma</a></td><td><a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank">â†’ USGS PR</a></td></tr>
        <tr><td style="color:var(--text);font-weight:700">RÃ­o Camuy</td><td>CMAP4</td><td><span class="rs" style="background:rgba(0,180,216,.15);color:var(--cyan);border:1px solid var(--cyan)">ACTIVO</span></td><td><a href="https://water.weather.gov/ahps2/hydrograph.php?gage=cmap4&wfo=sju" target="_blank">â†’ Hidrograma</a></td><td><a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank">â†’ USGS PR</a></td></tr>
        <tr><td style="color:var(--text);font-weight:700">RÃ­o ManatÃ­</td><td>MNTP4</td><td><span class="rs" style="background:rgba(0,180,216,.15);color:var(--cyan);border:1px solid var(--cyan)">ACTIVO</span></td><td><a href="https://water.weather.gov/ahps2/hydrograph.php?gage=mntp4&wfo=sju" target="_blank">â†’ Hidrograma</a></td><td><a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank">â†’ USGS PR</a></td></tr>
        <tr><td style="color:var(--text);font-weight:700">RÃ­o Cibuco</td><td>CBCP4</td><td><span class="rs" style="background:rgba(0,180,216,.15);color:var(--cyan);border:1px solid var(--cyan)">ACTIVO</span></td><td><a href="https://water.weather.gov/ahps2/hydrograph.php?gage=cbcp4&wfo=sju" target="_blank">â†’ Hidrograma</a></td><td><a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank">â†’ USGS PR</a></td></tr>
      </tbody>
    </table>
  </div>
  <div class="g2b">
    <div class="card">
      <div class="clbl">ğŸ—ºï¸ Mapas HidrolÃ³gicos</div>
      <div style="display:flex;flex-direction:column;gap:7px">
        <a href="https://water.weather.gov/ahps2/index.php?wfo=sju" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.5);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--teal)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700;font-size:.82rem">ğŸ—ºï¸ NWS AHPS â€” Mapa PR</span><span style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--teal)">â†’</span></a>
        <a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.5);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--teal)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700;font-size:.82rem">ğŸ“ˆ USGS Flujo Tiempo Real</span><span style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--teal)">â†’</span></a>
        <a href="https://www.weather.gov/sju/ahps" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.5);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--teal)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700;font-size:.82rem">ğŸ“Š HidrologÃ­a NWS SJU</span><span style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--teal)">â†’</span></a>
      </div>
    </div>
    <div class="card dc">
      <div class="clbl">âš ï¸ SeÃ±ales de Peligro</div>
      <div style="font-family:'Space Mono',monospace;font-size:.6rem;line-height:1.7;display:flex;flex-direction:column;gap:5px">
        <div style="padding:6px;background:rgba(230,57,70,.1);border-left:3px solid var(--danger)">ğŸ”´ <strong style="color:var(--danger)">FLOOD STAGE</strong> â€” InundaciÃ³n activa</div>
        <div style="padding:6px;background:rgba(255,107,53,.1);border-left:3px solid var(--warn)">ğŸŸ  <strong style="color:var(--warn)">ACTION STAGE</strong> â€” Monitoreo intensivo</div>
        <div style="padding:6px;background:rgba(255,209,102,.1);border-left:3px solid var(--gold)">ğŸŸ¡ <strong style="color:var(--gold)">MINOR FLOOD</strong> â€” Inundaciones menores</div>
        <div style="padding:6px;background:rgba(6,214,160,.1);border-left:3px solid var(--safe)">ğŸŸ¢ <strong style="color:var(--safe)">NORMAL</strong> â€” Nivel seguro</div>
        <div style="color:var(--muted);padding-top:3px;font-size:.56rem">âš¡ No cruce rÃ­os crecidos. 6 pulgadas de agua en movimiento pueden derribar a una persona.</div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â• NOTAS â•â•â• -->
<div id="panel-notas" class="panel">
  <div class="g2b">
    <div class="card">
      <div class="clbl">âœï¸ Nueva ObservaciÃ³n de Campo</div>
      <div class="nf">
        <div class="nr">
          <div><div class="nlbl">Tipo de evento</div>
            <select id="note-type">
              <option value="info">ğŸ“‹ ObservaciÃ³n General</option>
              <option value="menor">ğŸŸ¡ Evento Menor</option>
              <option value="moderado">ğŸŸ  Evento Moderado</option>
              <option value="severo">ğŸ”´ Evento Severo</option>
            </select>
          </div>
          <div><div class="nlbl">UbicaciÃ³n</div>
            <input type="text" id="note-loc" placeholder="Ej: RÃ­o Arecibo, Km 3.2" maxlength="80">
          </div>
        </div>
        <div><div class="nlbl">TÃ­tulo / Resumen</div>
          <input type="text" id="note-title" placeholder="Ej: RÃ­o desbordado en margen norte" maxlength="120">
        </div>
        <div><div class="nlbl">DescripciÃ³n detallada</div>
          <textarea id="note-body" placeholder="Describe condiciones: nivel del agua, Ã¡rea afectada, infraestructura daÃ±ada, personas afectadas, acciones tomadas..."></textarea>
        </div>
        <button class="btn-p" onclick="saveNote()">ğŸ’¾ Guardar ObservaciÃ³n</button>
      </div>
    </div>
    <div class="card">
      <div class="clbl">ğŸ“Š EstadÃ­sticas</div>
      <div class="nstats">
        <div class="nst"><div class="nsv" id="ns-total">0</div><div class="nsl">Total</div></div>
        <div class="nst"><div class="nsv" style="color:var(--danger)" id="ns-sev">0</div><div class="nsl">Severos</div></div>
        <div class="nst"><div class="nsv" style="color:var(--warn)" id="ns-mod">0</div><div class="nsl">Moderados</div></div>
        <div class="nst"><div class="nsv" style="color:var(--cyan)" id="ns-inf">0</div><div class="nsl">Info</div></div>
      </div>
      <div style="display:flex;gap:7px;flex-wrap:wrap;margin-bottom:10px">
        <button class="btn-p" onclick="exportNotes()" style="background:var(--ocean);color:var(--cyan);border:1px solid var(--cyan)">ğŸ“¤ Exportar TXT</button>
        <button class="btn-ds" onclick="clearNotes()" style="color:var(--muted);border-color:var(--muted)">ğŸ—‘ Borrar todas</button>
      </div>
      <div style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:1.8;padding:8px;background:rgba(0,180,216,.05);border:1px solid var(--border)">
        ğŸ’¾ Las notas se guardan en el navegador (localStorage). Permanecen al cerrar el dashboard. Usa "Exportar" para respaldo externo.
      </div>
    </div>
  </div>
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:7px">
      <div class="clbl" style="margin-bottom:0">ğŸ“ BitÃ¡cora de Observaciones</div>
      <select id="filter-type" onchange="renderNotes()" style="background:var(--input-bg);border:1px solid var(--input-border);color:var(--text);font-family:'Space Mono',monospace;font-size:.54rem;padding:4px 7px;">
        <option value="">Todos los tipos</option>
        <option value="severo">ğŸ”´ Severo</option>
        <option value="moderado">ğŸŸ  Moderado</option>
        <option value="menor">ğŸŸ¡ Menor</option>
        <option value="info">ğŸ“‹ Info</option>
      </select>
    </div>
    <div id="notes-list"><div class="ne">Sin observaciones aÃºn. Usa el formulario para registrar tu primera nota de campo.</div></div>
  </div>
</div>

<!-- â•â•â• RECURSOS â•â•â• -->
<div id="panel-recursos" class="panel">
  <div class="g2b">
    <div class="card">
      <div class="clbl">ğŸ“ Contactos de Emergencia</div>
      <div style="display:flex;flex-direction:column;gap:5px">
        <a href="tel:911" style="display:flex;justify-content:space-between;align-items:center;padding:10px;background:rgba(230,57,70,.12);border:1px solid rgba(230,57,70,.3);text-decoration:none"><span style="color:var(--text);font-weight:700">ğŸ†˜ Emergencias PR</span><span style="font-family:'Space Mono',monospace;font-size:1.1rem;color:var(--danger);font-weight:700">9-1-1</span></a>
        <a href="tel:7872534586" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--cyan)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700">ğŸŒ€ NWS San Juan</span><span style="font-family:'Space Mono',monospace;font-size:.82rem;color:var(--cyan)">(787) 253-4586</span></a>
        <a href="tel:7877240124" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--cyan)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700">ğŸš’ SCEM Puerto Rico</span><span style="font-family:'Space Mono',monospace;font-size:.82rem;color:var(--cyan)">(787) 724-0124</span></a>
        <a href="tel:7877233600" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--cyan)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700">ğŸ›£ï¸ DTOP</span><span style="font-family:'Space Mono',monospace;font-size:.82rem;color:var(--cyan)">(787) 723-3600</span></a>
        <a href="tel:7877597979" style="display:flex;justify-content:space-between;align-items:center;padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border);text-decoration:none;transition:all .2s" onmouseover="this.style.borderColor='var(--cyan)'" onmouseout="this.style.borderColor='var(--border)'"><span style="color:var(--text);font-weight:700">ğŸ¥ Cruz Roja PR</span><span style="font-family:'Space Mono',monospace;font-size:.82rem;color:var(--cyan)">(787) 759-7979</span></a>
      </div>
    </div>
    <div class="card">
      <div class="clbl">ğŸ“± Alertas en tu Dispositivo</div>
      <div style="display:flex;flex-direction:column;gap:7px;font-family:'Space Mono',monospace;font-size:.6rem;line-height:1.8">
        <div style="padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border)"><div style="color:var(--cyan);font-weight:700;margin-bottom:2px">ğŸ“§ Alertas por Email â€” NWS</div><a href="https://www.weather.gov/alerts" target="_blank" style="color:var(--teal)">weather.gov/alerts â†’ Puerto Rico</a><br><span style="color:var(--muted)">Flash Flood Â· Marine Â· Surf Â· Tropical</span></div>
        <div style="padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border)"><div style="color:var(--cyan);font-weight:700;margin-bottom:2px">ğŸ“² WEA â€” Alertas InalÃ¡mbricas</div><span style="color:var(--muted)">ConfiguraciÃ³n â†’ Notificaciones â†’ Alertas de Emergencia</span></div>
        <div style="padding:9px;background:rgba(14,58,110,.4);border:1px solid var(--border)"><div style="color:var(--cyan);font-weight:700;margin-bottom:2px">ğŸ¦ NWS en Redes</div><a href="https://twitter.com/NWSSanJuan" target="_blank" style="color:var(--teal)">@NWSSanJuan</a><span style="color:var(--muted)"> Â· </span><a href="https://facebook.com/NWSSanJuan" target="_blank" style="color:var(--teal)">Facebook NWS SJU</a></div>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="clbl">ğŸ”— Todos los Recursos Oficiales</div>
    <div class="rg">
      <a href="https://www.weather.gov/sju/" target="_blank" class="rc"><span class="ri">ğŸŒ€</span><span class="rn">NWS San Juan</span><span class="ru">weather.gov/sju</span></a>
      <a href="https://api.weather.gov/alerts/active?area=PR" target="_blank" class="rc"><span class="ri">âš¡</span><span class="rn">API Alertas NWS</span><span class="ru">Datos JSON tiempo real</span></a>
      <a href="https://water.weather.gov/ahps2/index.php?wfo=sju" target="_blank" class="rc"><span class="ri">ğŸï¸</span><span class="rn">AHPS HidrologÃ­a</span><span class="ru">RÃ­os PR tiempo real</span></a>
      <a href="https://radar.weather.gov/station/TJUA/standard" target="_blank" class="rc"><span class="ri">ğŸ“¡</span><span class="rn">Radar TJUA</span><span class="ru">NWS San Juan</span></a>
      <a href="https://www.nhc.noaa.gov/" target="_blank" class="rc"><span class="ri">ğŸŒ€</span><span class="rn">NHC Ciclones</span><span class="ru">nhc.noaa.gov</span></a>
      <a href="https://www.ndbc.noaa.gov/" target="_blank" class="rc"><span class="ri">ğŸŒŠ</span><span class="rn">NDBC Boyas</span><span class="ru">ndbc.noaa.gov</span></a>
      <a href="https://waterdata.usgs.gov/pr/nwis/rt" target="_blank" class="rc"><span class="ri">ğŸ“ˆ</span><span class="rn">USGS RÃ­os PR</span><span class="ru">Flujo tiempo real</span></a>
      <a href="https://tidesandcurrents.noaa.gov/stationhome.html?id=9752695" target="_blank" class="rc"><span class="ri">ğŸŒŠ</span><span class="rn">Mareas Arecibo</span><span class="ru">NOAA ID 9752695</span></a>
      <a href="https://www.spcpr.pr.gov/" target="_blank" class="rc"><span class="ri">ğŸš’</span><span class="rn">SCEM PR</span><span class="ru">spcpr.pr.gov</span></a>
    </div>
  </div>
</div>

</main>

<footer class="btmbar">
  <div class="srcs"><span class="l">Fuentes:</span><a href="https://api.weather.gov/" target="_blank">NWS API</a><a href="https://www.ndbc.noaa.gov/" target="_blank">NDBC</a><a href="https://water.weather.gov/" target="_blank">AHPS</a><a href="https://waterdata.usgs.gov/" target="_blank">USGS</a><a href="https://tidesandcurrents.noaa.gov/" target="_blank">NOAA Tides</a></div>
  <div id="lu">Cargando...</div>
</footer>

<div id="ib"><p>ğŸ“² <strong>Instala esta app en tu celular</strong><br>Accede sin abrir el navegador</p><div class="br"><button id="bti" onclick="installApp()">Instalar</button><button id="btd" onclick="document.getElementById('ib').style.display='none'">Ahora no</button></div></div>

<script>
'use strict';
/* â”€â”€ TEMA â”€â”€ */
function toggleTheme(){
  const h=document.documentElement,d=h.getAttribute('data-theme')==='dark';
  h.setAttribute('data-theme',d?'light':'dark');
  document.getElementById('theme-btn').textContent=d?'ğŸŒ™ Oscuro':'â˜€ï¸ Claro';
  document.getElementById('meta-theme').content=d?'#e8f2ff':'#0a1628';
  localStorage.setItem('theme',d?'light':'dark');
}
document.addEventListener('DOMContentLoaded',()=>{
  const s=localStorage.getItem('theme')||'dark';
  const b=document.getElementById('theme-btn');
  if(b) b.textContent=s==='light'?'ğŸŒ™ Oscuro':'â˜€ï¸ Claro';
});

/* â”€â”€ RELOJ â”€â”€ */
function updateClock(){
  const n=new Date(),o={timeZone:'America/Puerto_Rico'};
  document.getElementById('clock').textContent=n.toLocaleTimeString('es-PR',{...o,hour12:true}).toUpperCase();
  document.getElementById('date-display').textContent=n.toLocaleDateString('es-PR',{...o,weekday:'long',year:'numeric',month:'long',day:'numeric'}).toUpperCase();
}
setInterval(updateClock,1000);updateClock();

/* â”€â”€ TABS â”€â”€ */
function switchTab(name,el){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('panel-'+name).classList.add('active');
  if(el) el.classList.add('active');
}

/* â”€â”€ PWA â”€â”€ */
let dp=null;
window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();dp=e;document.getElementById('install-btn').style.display='block';setTimeout(()=>{document.getElementById('ib').style.display='block';},3000);});
function installApp(){if(!dp)return;dp.prompt();dp.userChoice.then(()=>{dp=null;document.getElementById('ib').style.display='none';document.getElementById('install-btn').style.display='none';});}

/* â”€â”€ NOTIFICACIONES â”€â”€ */
let notifOn=localStorage.getItem('notifOn')==='true';
function updateNotifUI(){
  const b=document.getElementById('ns-btn'),t=document.getElementById('ns-title'),d=document.getElementById('ns-desc'),bx=document.getElementById('ns-box');
  if(!('Notification'in window)){if(t)t.textContent='Notificaciones no soportadas';if(b)b.style.display='none';return;}
  const p=Notification.permission;
  if(p==='granted'&&notifOn){if(t)t.textContent='ğŸ”” Notificaciones ACTIVADAS';if(d)d.textContent='RecibirÃ¡s alertas Flash Flood y Severe cada 10 min';if(b){b.textContent='Desactivar';b.className='btn-n disable';}if(bx)bx.style.borderColor='var(--safe)';}
  else if(p==='denied'){if(t)t.textContent='ğŸš« Notificaciones bloqueadas';if(d)d.textContent='Ve a ConfiguraciÃ³n del navegador para permitirlas';if(b){b.textContent='Bloqueadas';b.disabled=true;}}
  else{if(t)t.textContent='ğŸ”• Notificaciones no activadas';if(d)d.textContent='Activa para recibir alertas aunque estÃ© cerrado';if(b){b.textContent='Activar';b.className='btn-n enable';}if(bx)bx.style.borderColor='';}
}
async function toggleNotif(){
  if(!('Notification'in window))return;
  if(notifOn&&Notification.permission==='granted'){notifOn=false;localStorage.setItem('notifOn','false');updateNotifUI();return;}
  const p=await Notification.requestPermission();
  if(p==='granted'){notifOn=true;localStorage.setItem('notifOn','true');updateNotifUI();new Notification('âœ… Monitor Arecibo',{body:'Notificaciones activadas. RecibirÃ¡s alertas NWS.'});}
  else updateNotifUI();
}
function testNotif(){
  if(Notification.permission!=='granted'){alert('Primero activa las notificaciones.');return;}
  new Notification('ğŸ§ª Prueba â€” Monitor Arecibo',{body:'âš ï¸ Esta es una notificaciÃ³n de prueba del sistema.',vibrate:[200,100,200]});
}
function checkNotif(alerts){
  if(!notifOn||Notification.permission!=='granted')return;
  const known=JSON.parse(localStorage.getItem('notifSent')||'[]');
  alerts.filter(a=>{const s=a.properties.severity,e=(a.properties.event||'').toLowerCase();return(s==='Extreme'||s==='Severe'||e.includes('flood')||e.includes('flash'))&&!known.includes(a.id);}).forEach(a=>{
    const p=a.properties;
    new Notification(`âš ï¸ ${p.event}`,{body:`${(p.headline||p.description||'').substring(0,120)}\nğŸ“ ${(p.areaDesc||'').split(';')[0]}`,vibrate:[300,100,300,100,300],requireInteraction:true,tag:a.id});
    known.push(a.id);
  });
  localStorage.setItem('notifSent',JSON.stringify(known.slice(-100)));
}
updateNotifUI();

/* â”€â”€ HISTORIAL â”€â”€ */
let alertHist=JSON.parse(localStorage.getItem('alertHist')||'[]');
function addHistory(alerts){
  const now=new Date().toLocaleString('es-PR',{timeZone:'America/Puerto_Rico'});
  alerts.forEach(a=>{if(!alertHist.some(h=>h.id===a.id)){const p=a.properties;alertHist.unshift({id:a.id,event:p.event,severity:p.severity,area:(p.areaDesc||'').split(';')[0],time:now});}});
  alertHist=alertHist.slice(0,50);localStorage.setItem('alertHist',JSON.stringify(alertHist));renderHistory();
}
function renderHistory(){
  const el=document.getElementById('alert-history');if(!el)return;
  if(!alertHist.length){el.innerHTML='<div class="ne">Sin historial aÃºn.</div>';return;}
  const sc={Extreme:'var(--danger)',Severe:'var(--warn)',Moderate:'var(--gold)',Minor:'var(--safe)'};
  el.innerHTML=alertHist.map(h=>`<div class="hi"><div class="hit">${h.time}</div><div class="hib" style="background:rgba(0,0,0,.2);color:${sc[h.severity]||'var(--cyan)'};border:1px solid ${sc[h.severity]||'var(--cyan)'}">${h.severity||'INFO'}</div><div class="hiT">${h.event}</div><div class="hiA">ğŸ“ ${h.area}</div></div>`).join('');
}
function clearHistory(){if(!confirm('Â¿Borrar historial?'))return;alertHist=[];localStorage.setItem('alertHist','[]');renderHistory();}
renderHistory();

/* â”€â”€ MAREAS â”€â”€ */
function generateTides(){
  const now=new Date(),pr=new Date(now.toLocaleString('en-US',{timeZone:'America/Puerto_Rico'}));
  const bp=(pr.getDate()*0.8+pr.getMonth()*2.3)%(2*Math.PI);
  const td=Array.from({length:24},(_,h)=>{const t=h/24;return Math.max(.05,.3+.25*Math.sin(2*Math.PI*2*t+bp)+.15*Math.sin(2*Math.PI*t+bp*.7));});
  const mx=Math.max(...td),mn=Math.min(...td),ch=pr.getHours();
  const hiI=td.indexOf(mx),loI=td.indexOf(mn);
  const fh=h=>{const hh=h%24,ap=hh<12?'AM':'PM',hd=hh===0?12:hh>12?hh-12:hh;return `${hd}:00 ${ap}`;};
  const render=(id,compact)=>{
    const el=document.getElementById(id);if(!el)return;
    const bars=td.map((v,i)=>{const p=((v-mn)/(mx-mn))*100,ht=Math.max(3,p*.54),isN=i===ch,isH=v>(mx+mn)/2;return `<div class="tide-b ${isH?'high':''} ${isN?'now':''}" style="height:${ht}px" title="${fh(i)}: ${v.toFixed(2)}m"></div>`;}).join('');
    const lbls=[0,6,12,18,23].map(h=>`<span>${fh(h)}</span>`).join('');
    el.innerHTML=`<div><div class="tide-tl">${bars}</div><div class="tide-lbls">${lbls}</div></div><div class="tide-row"><div class="tide-it"><div class="tl">ğŸ”º Pleamar</div><div class="tv" style="color:var(--gold)">${mx.toFixed(2)}m</div><div class="tt">${fh(hiI)}</div></div><div class="tide-it"><div class="tl">ğŸ”» Bajamar</div><div class="tv" style="color:var(--cyan)">${mn.toFixed(2)}m</div><div class="tt">${fh(loI)}</div></div><div class="tide-it"><div class="tl">ğŸ“ Ahora</div><div class="tv">${td[ch].toFixed(2)}m</div><div class="tt">${fh(ch)}</div></div></div>${!compact?`<div style="margin-top:8px;font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);padding:7px;border:1px solid var(--border)">âš ï¸ Datos calculados. Predicciones oficiales: <a href="https://tidesandcurrents.noaa.gov/noaatidepredictions.html?id=9752695" target="_blank" style="color:var(--cyan)">NOAA ID 9752695 â†’</a></div>`:''}`;
  };
  render('tides-home',true);render('tides-full',false);
}

/* â”€â”€ ALERTAS â”€â”€ */
async function loadAlerts(){
  try{
    const r=await fetch('https://api.weather.gov/alerts/active?area=PR&limit=25'),d=await r.json(),alerts=d.features||[];
    const bn=document.getElementById('alert-banner');
    if(alerts.length>0){
      bn.style.display='block';
      bn.innerHTML=alerts.slice(0,4).map(a=>{const p=a.properties,s=p.severity;let c='adv';if(s==='Extreme'||s==='Severe')c='';else if(s==='Moderate')c='warn';const e=p.expires?new Date(p.expires).toLocaleString('es-PR',{timeZone:'America/Puerto_Rico',weekday:'short',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'}):'Vigente';return `<div class="ai ${c}"><div class="ai-hdr"><span class="ai-type">âš ï¸ ${p.event||'Alerta'}</span><span class="ai-exp">Expira: ${e}</span></div><div class="ai-title">${(p.headline||p.event||'').split('*')[0].trim().substring(0,88)}</div><div class="ai-desc">${(p.headline||p.description||'').substring(0,190)}...</div></div>`;}).join('');
    }else bn.style.display='none';
    const af=document.getElementById('alerts-full');
    if(af){
      if(!alerts.length){af.innerHTML=`<div class="si"><span class="dot safe"></span><span style="color:var(--safe)">SIN ALERTAS ACTIVAS</span></div><div class="subinfo" style="margin-top:7px">No hay alertas vigentes para Puerto Rico.</div>`;}
      else{const sc={Extreme:'var(--danger)',Severe:'var(--warn)',Moderate:'var(--gold)',Minor:'var(--safe)'};af.innerHTML=`<div style="margin-bottom:8px;font-family:'Space Mono',monospace;font-size:.6rem;color:var(--muted)">${alerts.length} ALERTA${alerts.length>1?'S':''} ACTIVA${alerts.length>1?'S':''}</div>`+alerts.map(a=>{const p=a.properties,col=sc[p.severity]||'var(--gold)',exp=p.expires?new Date(p.expires).toLocaleString('es-PR',{timeZone:'America/Puerto_Rico',weekday:'short',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'}):'â€”';return `<div style="border:1px solid var(--border);padding:11px;margin-bottom:7px;background:rgba(14,58,110,.2)"><div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:5px;margin-bottom:5px"><span style="font-weight:700;font-size:.86rem;color:${col};text-transform:uppercase">${p.event}</span><span style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted)">Expira: ${exp}</span></div><div style="font-family:'Space Mono',monospace;font-size:.56rem;color:var(--muted);margin-bottom:5px">ğŸ“ ${(p.areaDesc||'').split(';').slice(0,3).join(' â€¢ ')}</div>${p.description?`<div style="font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text);line-height:1.6">${p.description.substring(0,320)}${p.description.length>320?'...':''}</div>`:''}</div>`;}).join('');}
    }
    addHistory(alerts);checkNotif(alerts);computeFloodRisk(alerts);
  }catch(e){
    const af=document.getElementById('alerts-full');if(af)af.innerHTML=`<div class="subinfo" style="color:var(--warn)">âš ï¸ Sin conexiÃ³n. <a href="https://www.weather.gov/sju/" target="_blank" style="color:var(--cyan)">â†’ weather.gov/sju</a></div>`;
    computeFloodRisk([]);
  }
}

function computeFloodRisk(alerts){
  const fl=alerts.filter(a=>{const e=(a.properties.event||'').toLowerCase();return e.includes('flood')||e.includes('flash');});
  let p=10,l='BAJO',c='var(--safe)';
  if(fl.some(a=>a.properties.severity==='Extreme')){p=95;l='EXTREMO';c='var(--danger)';}
  else if(fl.some(a=>a.properties.severity==='Severe')){p=72;l='ALTO';c='var(--warn)';}
  else if(fl.some(a=>a.properties.severity==='Moderate')){p=50;l='MODERADO';c='var(--gold)';}
  else if(fl.length>0){p=30;l='BAJO-MOD';c='var(--cyan)';}
  setTimeout(()=>{
    const gf=document.getElementById('gauge-fill');if(gf){gf.style.width=p+'%';gf.style.background=`linear-gradient(90deg,var(--ocean),${c})`;}
    const rv=document.getElementById('risk-value');if(rv){rv.textContent=p+'%';rv.style.color=c;}
    const rl=document.getElementById('risk-label');if(rl){rl.textContent=l;rl.style.color=c;}
  },400);
}

/* â”€â”€ TRADUCCIÃ“N NWS (inglÃ©s â†’ espaÃ±ol) â”€â”€ */
function traducir(txt){
  if(!txt) return '';
  const map=[
    // Condiciones generales
    [/Mostly Sunny/gi,'Mayormente Soleado'],[/Partly Sunny/gi,'Parcialmente Soleado'],
    [/Sunny/gi,'Soleado'],[/Mostly Clear/gi,'Mayormente Despejado'],[/Partly Cloudy/gi,'Parcialmente Nublado'],
    [/Mostly Cloudy/gi,'Mayormente Nublado'],[/Cloudy/gi,'Nublado'],[/Clear/gi,'Despejado'],
    [/Overcast/gi,'Cubierto'],
    // Lluvia
    [/Chance (of )?Showers/gi,'Posibilidad de Aguaceros'],[/Showers/gi,'Aguaceros'],
    [/Chance (of )?Rain/gi,'Posibilidad de Lluvia'],[/Light Rain/gi,'Lluvia Ligera'],
    [/Heavy Rain/gi,'Lluvia Intensa'],[/Rain/gi,'Lluvia'],
    [/Chance (of )?Drizzle/gi,'Posibilidad de Llovizna'],[/Drizzle/gi,'Llovizna'],
    // Tormentas
    [/Chance (of )?Thunderstorms/gi,'Posibilidad de Tormentas ElÃ©ctricas'],
    [/Thunderstorms/gi,'Tormentas ElÃ©ctricas'],
    [/Chance (of )?Storms/gi,'Posibilidad de Tormentas'],[/Storms/gi,'Tormentas'],
    // Tropical
    [/Tropical Storm/gi,'Tormenta Tropical'],[/Hurricane/gi,'HuracÃ¡n'],
    // Viento / niebla
    [/Breezy/gi,'Ventoso'],[/Windy/gi,'Vientos Fuertes'],[/Foggy/gi,'Neblinoso'],[/Fog/gi,'Neblina'],
    [/Haze/gi,'Bruma'],[/Hazy/gi,'Brumoso'],
    // Temperatura
    [/High near (\d+)/gi,'MÃ¡xima de $1Â°F'],[/Low around (\d+)/gi,'MÃ­nima de $1Â°F'],
    [/High around (\d+)/gi,'MÃ¡xima de $1Â°F'],[/Low near (\d+)/gi,'MÃ­nima de $1Â°F'],
    // Viento direcciÃ³n
    [/North wind/gi,'Viento del Norte'],[/South wind/gi,'Viento del Sur'],
    [/East wind/gi,'Viento del Este'],[/West wind/gi,'Viento del Oeste'],
    [/Northeast wind/gi,'Viento del Noreste'],[/Northwest wind/gi,'Viento del Noroeste'],
    [/Southeast wind/gi,'Viento del Sureste'],[/Southwest wind/gi,'Viento del Suroeste'],
    [/\bNorth\b/g,'Norte'],[/\bSouth\b/g,'Sur'],[/\bEast\b/g,'Este'],[/\bWest\b/g,'Oeste'],
    [/\bNE\b/g,'NE'],[/\bNW\b/g,'NO'],[/\bSE\b/g,'SE'],[/\bSW\b/g,'SO'],
    // Velocidad viento
    [/around (\d+) mph/gi,'alrededor de $1 mph'],[/(\d+) to (\d+) mph/gi,'$1 a $2 mph'],
    [/gusts as high as (\d+) mph/gi,'rÃ¡fagas hasta $1 mph'],
    [/with gusts/gi,'con rÃ¡fagas'],
    // Probabilidad
    [/A chance of/gi,'Posibilidad de'],[/Chance of precipitation is (\d+)%/gi,'Probabilidad de precipitaciÃ³n: $1%'],
    [/A slight chance of/gi,'Baja posibilidad de'],
    [/Likely/gi,'Probable'],[/Possible/gi,'Posible'],
    // Tiempo del dÃ­a
    [/\bThis morning\b/gi,'Esta maÃ±ana'],[/\bThis afternoon\b/gi,'Esta tarde'],
    [/\bTonight\b/gi,'Esta noche'],[/\bOvernight\b/gi,'Durante la noche'],
    [/\bThis evening\b/gi,'Esta noche'],[/\bBefore midnight\b/gi,'Antes de medianoche'],
    [/\bAfter midnight\b/gi,'DespuÃ©s de la medianoche'],
    [/\bTomorrow\b/gi,'MaÃ±ana'],[/\bTomorrow morning\b/gi,'MaÃ±ana en la maÃ±ana'],
    [/\bTomorrow afternoon\b/gi,'MaÃ±ana en la tarde'],
    [/\bMonday\b/gi,'Lunes'],[/\bTuesday\b/gi,'Martes'],[/\bWednesday\b/gi,'MiÃ©rcoles'],
    [/\bThursday\b/gi,'Jueves'],[/\bFriday\b/gi,'Viernes'],[/\bSaturday\b/gi,'SÃ¡bado'],[/\bSunday\b/gi,'Domingo'],
    // Otros comunes
    [/New rainfall amounts/gi,'AcumulaciÃ³n de lluvia'],[/between/gi,'entre'],
    [/Patchy/gi,'Parcial'],[/areas of/gi,'Ã¡reas de'],
    [/percent/gi,'por ciento'],
    [/and/gi,'y'],[/or/gi,'o'],[/with/gi,'con'],[/near/gi,'cerca de'],
    [/mainly/gi,'principalmente'],[/becoming/gi,'convirtiÃ©ndose en'],
    [/increasing to/gi,'aumentando a'],[/decreasing to/gi,'disminuyendo a'],
    [/in the morning/gi,'en la maÃ±ana'],[/in the afternoon/gi,'en la tarde'],[/in the evening/gi,'en la noche'],
  ];
  let r=txt;
  map.forEach(([re,es])=>{ r=r.replace(re,es); });
  return r;
}

/* â”€â”€ PRONÃ“STICO â”€â”€ */
async function loadForecast(){
  try{
    const pr=await fetch('https://api.weather.gov/points/18.4736,-66.7220'),pd=await pr.json();
    const fc=await(await fetch(pd.properties.forecast)).json();
    const periods=fc.properties.periods||[];
    const im={sunny:'â˜€ï¸',clear:'ğŸŒ™',partly:'â›…','mostly cloudy':'â˜ï¸',cloudy:'â˜ï¸',rain:'ğŸŒ§ï¸',showers:'ğŸŒ¦ï¸',thunder:'â›ˆï¸',storm:'ğŸŒ©ï¸',wind:'ğŸ’¨',fog:'ğŸŒ«ï¸',tropical:'ğŸŒ€',hurricane:'ğŸŒ€'};
    const gi=sf=>{const l=(sf||'').toLowerCase();for(const[k,v]of Object.entries(im)){if(l.includes(k))return v;}return 'ğŸŒ¤ï¸';};
    const dayP=periods.filter(p=>p.isDaytime).slice(0,7),nightP=periods.filter(p=>!p.isDaytime).slice(0,7);
    const rg=(days,id)=>{const el=document.getElementById(id);if(!el)return;el.innerHTML=days.map(p=>{const d=new Date(p.startTime),dn=d.toLocaleDateString('es-PR',{weekday:'short',timeZone:'America/Puerto_Rico'}).toUpperCase(),prob=p.probabilityOfPrecipitation?.value,ps=prob!=null?prob+'%':'â€”',rc=prob==null?'var(--muted)':prob<30?'var(--safe)':prob<60?'var(--gold)':prob<80?'var(--warn)':'var(--danger)';return `<div class="fcd"><div class="dn">${dn}</div><span class="di">${gi(p.shortForecast)}</span><div class="dt">${p.temperature}Â°${p.temperatureUnit}</div><div class="dr" style="color:${rc}">ğŸŒ§ ${ps}</div><div class="ds">${traducir(p.shortForecast||'').substring(0,26)}</div></div>`;}).join('');};
    rg(dayP,'fcg-home');rg(dayP,'fcg-full');
    const ne=document.getElementById('night-fc');
    if(ne)ne.innerHTML=nightP.slice(0,4).map(p=>{const d=new Date(p.startTime),dn=d.toLocaleDateString('es-PR',{weekday:'long',timeZone:'America/Puerto_Rico'}).toUpperCase(),prob=p.probabilityOfPrecipitation?.value,rc=prob==null?'var(--muted)':prob<30?'var(--safe)':prob<60?'var(--gold)':prob<80?'var(--warn)':'var(--danger)';return `<div style="border-bottom:1px solid var(--border);padding:7px 0"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2px"><span style="font-weight:700;font-size:.78rem">${gi(p.shortForecast)} ${dn}</span><span style="font-family:'Space Mono',monospace;font-size:.58rem;color:${rc}">ğŸŒ§ ${prob!=null?prob+'%':'â€”'}</span></div><div style="font-family:'Space Mono',monospace;font-size:.57rem;color:var(--muted);line-height:1.5">${traducir(p.detailedForecast||'').substring(0,180)}...</div></div>`;}).join('');
    const fd=document.getElementById('fc-detail');
    if(fd)fd.innerHTML=dayP.slice(0,3).map(p=>{const d=new Date(p.startTime),dn=d.toLocaleDateString('es-PR',{weekday:'long',month:'short',day:'numeric',timeZone:'America/Puerto_Rico'}).toUpperCase();return `<div style="border-bottom:1px solid var(--border);padding:7px 0"><div style="font-weight:700;font-size:.78rem;margin-bottom:2px">${gi(p.shortForecast)} ${dn}</div><div style="font-family:'Space Mono',monospace;font-size:.57rem;color:var(--muted);line-height:1.5">${traducir(p.detailedForecast||'').substring(0,200)}...</div></div>`;}).join('');
    const t=periods[0],tm=periods.find(p=>p.isDaytime&&periods.indexOf(p)>0);
    const tR=t?.probabilityOfPrecipitation?.value??'â€”',tmR=tm?.probabilityOfPrecipitation?.value??'â€”',tD=traducir(t?.detailedForecast||'');
    const ri=document.getElementById('rain-info');
    if(ri)ri.innerHTML=`<div style="margin-bottom:10px"><div style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-bottom:1px">HOY</div><div style="font-size:clamp(1.5rem,4vw,2.6rem);font-weight:900;line-height:1;color:${tR>60?'var(--warn)':'var(--safe)'}">${tR}%</div><div style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted);margin-top:1px">PROB. PRECIPITACIÃ“N</div></div><div style="margin-bottom:9px"><div style="font-family:'Space Mono',monospace;font-size:.54rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;margin-bottom:1px">MAÃ‘ANA</div><div style="font-size:1.4rem;font-weight:700;color:${tmR>60?'var(--warn)':'var(--text)'}">${tmR}%</div></div><div style="font-family:'Space Mono',monospace;font-size:.57rem;color:var(--muted);line-height:1.6;border-top:1px solid var(--border);padding-top:7px">${tD.substring(0,220)}${tD.length>220?'...':''}</div>`;
    const hR=tR>50,hH=tR>80,ss=document.getElementById('status-summary');
    if(ss)ss.innerHTML=`<div style="display:flex;flex-direction:column;gap:8px"><div class="si"><span class="dot ${hH?'danger':hR?'warn':'safe'}"></span><span style="color:${hH?'var(--danger)':hR?'var(--warn)':'var(--safe)'}">Lluvia hoy: ${hH?'ALTA':hR?'MODERADA':'BAJA'}</span></div><div class="si"><span class="dot warn"></span><span style="color:var(--warn)">Costa Norte: AVISO</span></div><div class="si"><span class="dot info"></span><span style="color:var(--cyan)">RÃ­os: ver pestaÃ±a RÃOS</span></div><div style="border-top:1px solid var(--border);margin-top:5px;padding-top:8px;font-family:'Space Mono',monospace;font-size:.58rem;color:var(--muted);line-height:2">ğŸ“ <a href="tel:7872534586" style="color:var(--cyan)">NWS: (787) 253-4586</a><br>ğŸ†˜ <a href="tel:911" style="color:var(--danger);font-weight:700">Emergencias: 9-1-1</a></div></div>`;
  }catch(e){['fcg-home','fcg-full'].forEach(id=>{const el=document.getElementById(id);if(el)el.innerHTML=`<div style="grid-column:1/-1;font-family:'Space Mono',monospace;font-size:.6rem;color:var(--warn)">âš ï¸ Sin conexiÃ³n. <a href="https://forecast.weather.gov/MapClick.php?CityName=Arecibo&state=PR" target="_blank" style="color:var(--cyan)">â†’ NWS</a></div>`;});}
}

/* â”€â”€ MARÃTIMO â”€â”€ */
function loadMaritime(){
  const d=[{l:'Oleaje',v:'9-10 pies',c:'danger'},{l:'Vientos',v:'E 10-20 kt, rÃ¡f. 30 kt',c:'warn'},{l:'PerÃ­odo',v:'8-10 seg.',c:'warn'},{l:'Corrientes',v:'Peligrosas',c:'danger'},{l:'Surf',v:'Peligroso',c:'danger'},{l:'Aviso',v:'VIGENTE',c:'danger'}];
  const rows=d.map(m=>`<tr><td>${m.l}</td><td><span class="ml ${m.c}">${m.v}</span></td></tr>`).join('');
  ['mt-home','mt-full'].forEach(id=>{const el=document.getElementById(id);if(el)el.innerHTML=rows;});
  ['mr1','mr2'].forEach(id=>{const el=document.getElementById(id);if(el)el.style.display='block';});
}

/* â”€â”€ NOTAS DE CAMPO â”€â”€ */
let fNotes=JSON.parse(localStorage.getItem('fNotes')||'[]');
const tl={severo:'ğŸ”´ Severo',moderado:'ğŸŸ  Moderado',menor:'ğŸŸ¡ Menor',info:'ğŸ“‹ Info'};
function saveNote(){
  const type=document.getElementById('note-type').value,title=document.getElementById('note-title').value.trim(),body=document.getElementById('note-body').value.trim(),loc=document.getElementById('note-loc').value.trim();
  if(!title&&!body){alert('Escribe al menos un tÃ­tulo o descripciÃ³n.');return;}
  const now=new Date().toLocaleString('es-PR',{timeZone:'America/Puerto_Rico'});
  fNotes.unshift({id:Date.now(),type,title:title||'Sin tÃ­tulo',body,location:loc,time:now});
  localStorage.setItem('fNotes',JSON.stringify(fNotes));
  document.getElementById('note-title').value='';document.getElementById('note-body').value='';document.getElementById('note-loc').value='';
  renderNotes();updateNoteStats();
}
function deleteNote(id){fNotes=fNotes.filter(n=>n.id!==id);localStorage.setItem('fNotes',JSON.stringify(fNotes));renderNotes();updateNoteStats();}
function renderNotes(){
  const el=document.getElementById('notes-list');if(!el)return;
  const f=(document.getElementById('filter-type')||{}).value||'';
  const shown=f?fNotes.filter(n=>n.type===f):fNotes;
  if(!shown.length){el.innerHTML=`<div class="ne">Sin observaciones${f?' para este tipo':' aÃºn'}.</div>`;return;}
  el.innerHTML=shown.map(n=>`<div class="nc ${n.type}"><div class="nc-hdr"><div class="nc-meta"><span class="nt ${n.type}">${tl[n.type]||n.type}</span><span class="nc-time">ğŸ• ${n.time}</span></div><div class="nca"><button class="btn-ds" onclick="deleteNote(${n.id})">âœ•</button></div></div><div class="nc-title">${n.title}</div>${n.body?`<div class="nc-body">${n.body}</div>`:''} ${n.location?`<div class="nc-loc">ğŸ“ ${n.location}</div>`:''}</div>`).join('');
}
function updateNoteStats(){
  const t=fNotes.length,s=fNotes.filter(n=>n.type==='severo').length,m=fNotes.filter(n=>n.type==='moderado').length,i=fNotes.filter(n=>n.type==='info'||n.type==='menor').length;
  const ns=(id,v)=>{const el=document.getElementById(id);if(el)el.textContent=v;};
  ns('ns-total',t);ns('ns-sev',s);ns('ns-mod',m);ns('ns-inf',i);
}
function clearNotes(){if(!confirm('Â¿Borrar TODAS las observaciones?'))return;fNotes=[];localStorage.setItem('fNotes','[]');renderNotes();updateNoteStats();}
function exportNotes(){
  if(!fNotes.length){alert('No hay observaciones.');return;}
  const now=new Date().toLocaleString('es-PR',{timeZone:'America/Puerto_Rico'});
  let txt=`BITÃCORA DE CAMPO â€” MONITOR METEOROLÃ“GICO ARECIBO, PR\nExportado: ${now}\n${'â•'.repeat(60)}\n\n`;
  fNotes.forEach((n,i)=>{txt+=`[${i+1}] ${(tl[n.type]||n.type).toUpperCase()}\nFecha/Hora: ${n.time}\nTÃ­tulo: ${n.title}\n`;if(n.location)txt+=`UbicaciÃ³n: ${n.location}\n`;if(n.body)txt+=`DescripciÃ³n:\n${n.body}\n`;txt+=`${'â”€'.repeat(40)}\n\n`;});
  const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([txt],{type:'text/plain;charset=utf-8'}));a.download=`Bitacora_Arecibo_${new Date().toISOString().slice(0,10)}.txt`;a.click();
}
renderNotes();updateNoteStats();

/* â”€â”€ SATÃ‰LITE GOES â”€â”€ */
function refreshGOES(){
  const img=document.getElementById('goes-img');
  if(!img) return;
  const base='https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/pr/GEOCOLOR/latest.jpg';
  img.src=base+'?t='+Date.now(); // cache-bust
}

/* â”€â”€ REPORTE PDF â”€â”€ */
async function loadReporteInfo(){
  try{
    const r=await fetch('reports/reporte_info.json?t='+Date.now());
    if(!r.ok) return;
    const info=await r.json();
    const card=document.getElementById('card-reporte');
    const div=document.getElementById('reporte-info');
    const btn=document.getElementById('pdf-btn');
    if(card) card.style.display='block';
    if(btn)  btn.style.display='inline-block';
    if(div) div.innerHTML=
      `ğŸ“… <strong style="color:var(--text)">${info.fecha||'â€”'}</strong><br>`+
      `ğŸ• Generado: <strong style="color:var(--text)">${info.hora||'â€”'}</strong><br>`+
      `âš ï¸ Alertas: <strong style="color:var(--${info.alertas_total>0?'warn':'safe'})">${info.alertas_total}</strong> total Â· `+
      `<strong style="color:var(--${info.alertas_inundacion>0?'danger':'safe'})">${info.alertas_inundacion}</strong> inundaciÃ³n<br>`+
      `ğŸŒ§ï¸ Lluvia hoy: <strong style="color:var(--${(info.lluvia_hoy_pct||0)>=60?'warn':'safe'})">${info.lluvia_hoy_pct!=null?info.lluvia_hoy_pct+'%':'â€”'}</strong> Â· `+
      `Riesgo: <strong style="color:var(--${info.riesgo==='EXTREMO'?'danger':info.riesgo==='ALTO'?'warn':info.riesgo==='MODERADO'?'gold':'safe'})">${info.riesgo}</strong>`;
  }catch(e){
    // No hay reporte todavÃ­a â€” silencioso
  }
}

/* â”€â”€ CARGA PRINCIPAL â”€â”€ */
async function loadAllData(){
  const btn=document.getElementById('refresh-btn');
  if(btn){btn.textContent='â†» Cargando...';btn.classList.add('active');}
  await Promise.all([loadAlerts(),loadForecast()]);
  loadMaritime();generateTides();loadReporteInfo();
  const lu=document.getElementById('lu');
  if(lu)lu.textContent='â¬†ï¸ '+new Date().toLocaleString('es-PR',{timeZone:'America/Puerto_Rico'}).toUpperCase()+' AST';
  if(btn){btn.textContent='âŸ³ Actualizar';btn.classList.remove('active');}
}
loadAllData();
setInterval(loadAllData,10*60*1000);
</script>
</body>
</html>
